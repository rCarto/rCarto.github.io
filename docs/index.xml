<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>R Geomatic</title>
<link>https://rcarto.github.io/index.html</link>
<atom:link href="https://rcarto.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description>Information on R spatial packages maintained by Timothée Giraud.</description>
<generator>quarto-1.3.433</generator>
<lastBuildDate>Mon, 10 Jul 2023 22:00:00 GMT</lastBuildDate>
<item>
  <title>New release of mapsf</title>
  <dc:creator>Timothée Giraud</dc:creator>
  <link>https://rcarto.github.io/posts/mapsf_v0.7.0/index.html</link>
  <description><![CDATA[ 



<p>A minor update of <code>mapsf</code> has been deployed on CRAN. In this article I’ll describe the changes introduced by this update.</p>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<section id="expandbb" class="level3">
<h3 class="anchored" data-anchor-id="expandbb"><code>expandBB</code></h3>
<p>An <code>expandBB</code> argument has been introduced in <code>mf_map()</code>. This argument allows to add some space around a map.</p>
<p>The following code displays a map with some extra space on the right side of the figure. This can be useful to add legends or annotations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mapsf)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb1-3">nc_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_read</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shape/nc.shp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-4">nc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(nc_raw, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:32019"</span>)</span>
<span id="cb1-5">th <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_theme</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"candy"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mar =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ivory"</span>)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.7.0/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mf_get_ratio(nc[1,], expandBB = c(0,0.5,0,0), width = 3.5)</span></span></code></pre></div>
</div>
<p>This addition makes the <code>mf_init()</code> function virtually useless. These two script produce the same output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with mf_init()</span></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_init</span>(nc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ],  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># without mf_init()</span></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.7.0/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This argument has also been added to <code>mf_raster()</code>.</p>
</section>
<section id="mf_graticule" class="level3">
<h3 class="anchored" data-anchor-id="mf_graticule"><code>mf_graticule()</code></h3>
<p>A new <code>mf_graticule()</code> function has been added to the package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_graticule</span>(nc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.7.0/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Graticules labels can be added on the four sides of the map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(nc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>))</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_graticule</span>(nc, </span>
<span id="cb5-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pos =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>), </span>
<span id="cb5-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb5-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb5-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.7.0/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>From <a href="https://r-spatial.github.io/sf/reference/st_graticule.html#use-of-graticules"><code>st_graticule()</code></a>:<br>
In cartographic visualization, the use of graticules is not advised, unless the graphical output will be used for measurement or navigation, or the direction of North is important for the interpretation of the content, or the content is intended to display distortions and artifacts created by projection. Unnecessary use of graticules only adds visual clutter but little relevant information. Use of coastlines, administrative boundaries or place names permits most viewers of the output to orient themselves better than a graticule.</p>
</div>
</div>
</section>
</section>
<section id="fixes" class="level2">
<h2 class="anchored" data-anchor-id="fixes">Fixes</h2>
<section id="pipe" class="level3">
<h3 class="anchored" data-anchor-id="pipe">Pipe</h3>
<p>The pipe compatibility of <code>mapsf</code> has been enhanced and it now works on most use cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_mtq</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ivory4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POP"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prop"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_graticule</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.7.0/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="384"></p>
</div>
</div>
</section>
<section id="themes" class="level3">
<h3 class="anchored" data-anchor-id="themes">Themes</h3>
<p>The graphic theme feature has been refactored. The current theme parameters are now accessible via R options (with the <strong>mapsf.</strong> prefix).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_theme</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$bg
[1] "#1B1D16"

$fg
[1] "#D7FF68"

$mar
[1] 0.5 0.5 2.0 0.5

$tab
[1] FALSE

$pos
[1] "center"

$inner
[1] FALSE

$line
[1] 1.5

$cex
[1] 1

$font
[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapsf.bg"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#1B1D16"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapsf.fg"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#D7FF68"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapsf.pos"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "center"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># etc</span></span></code></pre></div>
</div>
<p>The current theme is applied to all maps and there is no need to use the <code>theme</code> argument in <code>mf_export()</code> or <code>mf_init()</code> anymore.</p>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<p>The next release of <code>mapsf</code> will use the <a href="https://github.com/riatelab/maplegend"><code>maplegend</code></a> package (not on CRAN yet) for plotting legends. This will allow to plot horizontal legends (<a href="https://github.com/riatelab/mapsf/issues/19">#19</a>) and continuous legends for rasters (<a href="https://github.com/riatelab/mapsf/issues/22">#22</a>).</p>
<hr>
<p><strong>See the <a href="https://raw.githubusercontent.com/riatelab/mapsf/master/NEWS">NEWS file</a> for the complete list of changes.</strong></p>


</section>

 ]]></description>
  <category>mapsf</category>
  <guid>https://rcarto.github.io/posts/mapsf_v0.7.0/index.html</guid>
  <pubDate>Mon, 10 Jul 2023 22:00:00 GMT</pubDate>
  <media:content url="https://rcarto.github.io/posts/mapsf_v0.7.0/grat.png" medium="image" type="image/png" height="56" width="144"/>
</item>
<item>
  <title>New release of cartography</title>
  <dc:creator>Timothée Giraud</dc:creator>
  <link>https://rcarto.github.io/posts/cartography_v3.1.3/index.html</link>
  <description><![CDATA[ 



<p>A new version of <code>cartography</code> has been <a href="https://CRAN.R-project.org/package=cartography">released on CRAN</a> this week. <code>cartography</code> is a thematic mapping package for R that has entered in maintenance mode on March 2021.</p>
<p>This release has been triggered by the upcoming retirement (archiving) of <code>rgdal</code>, <code>rgeos</code> and <code>maptools</code> (see <a href="https://r-spatial.org/r/2022/04/12/evolution.html">R-spatial evolution: retirement of rgdal, rgeos and maptools</a> and <a href="https://r-spatial.org/r/2022/12/14/evolution2.html">Progress on R-spatial evolution, Dec 2022</a>).<br>
So, this release does not import any of these packages anymore and this is done at the cost of losing one function: <code>getTiles()</code>. The purpose of <code>getTiles()</code> was to download and compose raster tiles from a large number of providers.<br>
Fortunately, the <a href="https://github.com/riatelab/maptiles"><code>maptiles</code></a> package can be used to replace this function. It has the same features and is more robust.</p>
<p>For the same kind of reasons, <code>smoothLayer()</code> function has been deprecated. This function is using the <code>SpatialPosition</code> package to compute potentials. Potentials computations are now offered by the <code>potential</code> package.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key messages for <code>cartography</code> users
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Consider switching from <code>cartography</code> to <code>mapsf</code>. <code>mapsf</code> is the successor of <code>cartography</code>, it offers the same core features, it is friendlier, lighter and more robust.<br>
</li>
<li>Use <code>maptiles</code> instead of <code>getTiles()</code>. It offers the same features using a modern packages.</li>
<li>Use <code>potential</code> instead of <code>smoothLayer()</code>. It offers more features using modern packages.</li>
</ul>
<p><a href="https://riatelab.github.io/mapsf"><img src="https://rcarto.github.io/posts/cartography_v3.1.3/mapsf.png" class="img-fluid" width="120"></a> <a href="https://github.com/riatelab/maptiles"><img src="https://rcarto.github.io/posts/cartography_v3.1.3/maptiles.png" class="img-fluid" width="120"></a> <a href="https://riatelab.github.io/potential"><img src="https://rcarto.github.io/posts/cartography_v3.1.3/potential.png" class="img-fluid" width="120"></a></p>
</div>
</div>
<p><strong>See the <a href="https://raw.githubusercontent.com/riatelab/cartography/master/NEWS">NEWS file</a> for the complete list of changes.</strong></p>



 ]]></description>
  <category>cartography</category>
  <guid>https://rcarto.github.io/posts/cartography_v3.1.3/index.html</guid>
  <pubDate>Thu, 19 Jan 2023 23:00:00 GMT</pubDate>
  <media:content url="https://rcarto.github.io/posts/cartography_v3.1.3/cartography.png" medium="image" type="image/png" height="166" width="144"/>
</item>
<item>
  <title>New release of mapsf</title>
  <dc:creator>Timothée Giraud</dc:creator>
  <link>https://rcarto.github.io/posts/mapsf_v0.6.1/index.html</link>
  <description><![CDATA[ 



<p>The R spatial ecosystem is rich, dynamic and mature and several packages allow to import, process and represent spatial data. The <a href="https://CRAN.R-project.org/package=mapsf"><code>mapsf</code></a> package <span class="citation" data-cites="mapsf">(Giraud 2022)</span> relies on this ecosystem to integrate the creation of quality thematic maps in R workflows. <code>mapsf</code> uses <code>sf</code> objects to produce <code>base</code> graphics.</p>
<p>A minor update of <code>mapsf</code> has been deployed on CRAN. In this article I’ll describe the changes introduced by this update. <code>mapsf</code> has noticeably gained a new function, <code>mf_get_ratio()</code>, that helps to create map figures with suitable width / height ratios. Most of the other changes are bug fixes and small improvements.</p>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New features</h2>
<section id="mf_get_ratio" class="level3">
<h3 class="anchored" data-anchor-id="mf_get_ratio"><code>mf_get_ratio()</code></h3>
<p><code>mf_get_ratio()</code> can be used to create map figures with a suitable width / height ratio in reports (*.Rmd, *.qmd).<br>
It uses the width / height ratio of a spatial object bounding box to find a matching ratio for the map.<br>
The following quarto example uses the default figure output settings (7 x 5 inches):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mapsf)</span>
<span id="cb1-3">mtq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_mtq</span>()</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_theme</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkula"</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq)</span>
<span id="cb1-6"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.6.1/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The width / height ratio of this figure is not optimal, it produces a lot of unused space on the sides of the map. It is not easy to find a correct ratio without manually fiddling with the <strong>fig-width</strong> and <strong>fig-height</strong> values and this can be exhausting.<br>
<code>mf_get_ratio()</code> helps with this task:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_ratio</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkula"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.3 5.0</code></pre>
</div>
</div>
<p>We can use these values to obtain a much more satisfactory figure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| fig-width: 4.3</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| fig-height: 5</span></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_theme</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkula"</span>)</span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq)</span>
<span id="cb4-6"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.6.1/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="412"></p>
</div>
</div>
<p>The <code>mf_init()</code> function can be used to expand the map space in any direction thanks to its <strong>expandBB</strong> argument.<br>
Lets say we want to produce a figure that uses the <strong>ink</strong> theme, with a height of 5 inches and some space left on the right of the map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_ratio</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq, </span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ink"</span>, </span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb5-6">)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.95 5.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| fig-width: 5.95</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| fig-height: 5</span></span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_init</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ink"</span>)</span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Martinique"</span>)</span>
<span id="cb7-7"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.6.1/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="571"></p>
</div>
</div>
</section>
<section id="maps-of-proportional-and-colored-lines" class="level3">
<h3 class="anchored" data-anchor-id="maps-of-proportional-and-colored-lines">Maps of proportional and colored lines</h3>
<p>It is now possible to create maps that combine proportional lines and colors using the <strong>prop_typo</strong> map type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_theme</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"default"</span>)</span>
<span id="cb8-2">mtq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_mtq</span>()</span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import the csv file embedded in mapsf</span></span>
<span id="cb8-4">mob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"csv/mob.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapsf"</span>))</span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select links from Fort-de-France (97209))</span></span>
<span id="cb8-6">mob_97209 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mob[mob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">97209</span>, ]</span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create an sf object of links</span></span>
<span id="cb8-8">mob_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_links</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> mob_97209)</span>
<span id="cb8-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initiate a map with some space on the right</span></span>
<span id="cb8-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_init</span>(mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expandBB =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb8-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">add =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb8-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(</span>
<span id="cb8-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mob_links,</span>
<span id="cb8-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fij"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sj"</span>),</span>
<span id="cb8-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prop_typo"</span>,</span>
<span id="cb8-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb8-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leg_pos =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>),</span>
<span id="cb8-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leg_title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nb. of commuters"</span>, </span>
<span id="cb8-19">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Municipality status"</span>)</span>
<span id="cb8-20">)</span>
<span id="cb8-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># map layout</span></span>
<span id="cb8-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_layout</span>(</span>
<span id="cb8-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commuting from Fort-de-France"</span>,</span>
<span id="cb8-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">credits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb8-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sources: Insee and IGN, 2018</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb8-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapsf "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">packageVersion</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapsf"</span>)</span>
<span id="cb8-27">  ),</span>
<span id="cb8-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb8-29">)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.6.1/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
</section>
<section id="bug-fixes-and-improvements" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes-and-improvements">Bug fixes and improvements</h2>
<ul>
<li>Messages are now displayed when users map proportional symbols based on a variable that contained either <code>NA</code>, <code>0</code>, <code>Inf</code> or negative values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mapsf)</span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import sample dataset</span></span>
<span id="cb9-3">mtq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_mtq</span>()</span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># introduce NA, 0, Inf and negative values</span></span>
<span id="cb9-5">mtq[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POP"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>)</span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display basemap</span></span>
<span id="cb9-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq)</span>
<span id="cb9-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POP"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prop"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2 'NA' values are not plotted on the map.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2 '0' values are not plotted on the map.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2 'Infinite' values are not plotted on the map.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Negative values have been transformed into positive values.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.6.1/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<ul>
<li><p><code>mf_get_breaks()</code> is a function that helps to classify continuous variables using various methods, including the ones from <code>classInt::classIntervals</code> <span class="citation" data-cites="classInt">(Bivand 2022)</span>. A control has been added for <code>Inf</code> values and the <strong>geom</strong> method now outputs an error when all values are not strictly positive.</p></li>
<li><p>It is now possible to create maps with only one proportional symbol. This can be useful when maps are generated iterating over multiple territories: some of them may have only one point to plot (see <a href="https://github.com/riatelab/mapsf/issues/45">issue #45</a>).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">opar <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb14-2">mtq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_get_mtq</span>()</span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,])</span>
<span id="cb14-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, ], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POP"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prop"</span>, </span>
<span id="cb14-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">val_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">leg_pos =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottomleft"</span>)</span>
<span id="cb14-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(mtq[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,])</span>
<span id="cb14-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mf_map</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mtq[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, ], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POP"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prop"</span>, </span>
<span id="cb14-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">val_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85000</span>)</span>
<span id="cb14-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(opar)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://rcarto.github.io/posts/mapsf_v0.6.1/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p><strong>See the <a href="https://raw.githubusercontent.com/riatelab/mapsf/master/NEWS">NEWS file</a> for the complete list of changes.</strong></p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-classInt" class="csl-entry">
Bivand, Roger. 2022. <em>classInt: Choose Univariate Class Intervals</em>. <a href="https://CRAN.R-project.org/package=classInt">https://CRAN.R-project.org/package=classInt</a>.
</div>
<div id="ref-mapsf" class="csl-entry">
Giraud, Timothée. 2022. <em><span class="nocase">mapsf</span>: Thematic Cartography</em>. <a href="https://CRAN.R-project.org/package=mapsf">https://CRAN.R-project.org/package=mapsf</a>.
</div>
</div></section></div> ]]></description>
  <category>mapsf</category>
  <guid>https://rcarto.github.io/posts/mapsf_v0.6.1/index.html</guid>
  <pubDate>Mon, 12 Dec 2022 23:00:00 GMT</pubDate>
  <media:content url="https://rcarto.github.io/posts/mapsf_v0.6.1/mapsf.png" medium="image" type="image/png" height="166" width="144"/>
</item>
<item>
  <title>New release of osrm</title>
  <dc:creator>Timothée Giraud</dc:creator>
  <link>https://rcarto.github.io/posts/osrm_v4.0.0/index.html</link>
  <description><![CDATA[ 



<p><a href="https://CRAN.R-project.org/package=osrm"><code>osrm</code></a> is an interface between R and the <a href="https://github.com/Project-OSRM/osrm-backend">Open Source Routing Machine</a> (OSRM) API. OSRM <span class="citation" data-cites="luxen-vetter-2011">(Luxen and Vetter 2011)</span> is a routing service based on OpenStreetMap (OSM) data. This package enables the computation of routes, trips, isochrones and travel distances matrices (travel times and kilometric distances) based on the OSM road network.</p>
<p>A major update of <code>osrm</code> has been deployed on CRAN two weeks ago. In this article I’ll describe the changes introduced by this update and explain its context: the submission of a paper <span class="citation" data-cites="giraud2022">(Giraud 2022)</span> about the package in <a href="https://joss.theoj.org/">Journal of Open Source Software</a> (JOSS).</p>
<section id="what-has-changed" class="level2">
<h2 class="anchored" data-anchor-id="what-has-changed">What has changed</h2>
<p>This major release introduces a number of changes to the package API, some of them are <a href="https://en.wiktionary.org/wiki/breaking_change">breaking changes</a>.</p>
<section id="sp-support" class="level3">
<h3 class="anchored" data-anchor-id="sp-support"><code>sp</code> support</h3>
<p>Users will no longer have the possibility to use an <code>sp</code> object as input or output in <code>osrm</code> functions. Most of <em>#rspatial</em> users and package developers have moved from the old <code>sp</code>/<code>rgeos</code>/<code>rgdal</code> trilogy toward the <code>sf</code> package.</p>
</section>
<section id="refactoring-of-the-request-handling-process" class="level3">
<h3 class="anchored" data-anchor-id="refactoring-of-the-request-handling-process">Refactoring of the request handling process</h3>
<p>The way requests are sent to the OSRM server (local/remote/demo) has been refactored in order to get more informative messages. Indeed, an important share of the issues posted on the <a href="https://github.com/riatelab/osrm/issues"><code>osrm</code> GitHub repo</a> has been about cryptic or non helpful error messages sent by the package or the server. So in this release OSRM server errors are more explicit and better transmitted to the user.</p>
</section>
<section id="dependencies" class="level3">
<h3 class="anchored" data-anchor-id="dependencies">Dependencies</h3>
<p>OSRM request are received as json files to the package. Former versions of the package used <code>jsonlite</code>. Following a suggestion by <a href="https://github.com/neon-ninja">Nick Young</a> I’ve replaced this package by a much more efficient package (for large files), <a href="https://CRAN.R-project.org/package=RcppSimdJson"><code>RcppSimdJson</code></a>.<br>
The construction of isochrones as polygons was based on an ad-hoc code supported by <a href="https://CRAN.R-project.org/package=isoband"><code>isoband</code></a>. This piece of code was replicated in 2 other packages (<a href="https://CRAN.R-project.org/package=tanaka"><code>tanaka</code></a> and <a href="https://CRAN.R-project.org/package=potential"><code>potential</code></a>). I’ve decided to create the <a href="https://CRAN.R-project.org/package=mapiso"><code>mapiso</code></a> package to avoid an unnecessary maintenance burden and fortify the underlying code.</p>
</section>
<section id="input-types" class="level3">
<h3 class="anchored" data-anchor-id="input-types">Input types</h3>
<p>Input type checking has been largely improved. This improvement have lead to a modification of the set of valid input of functions. Most functions accept data.frame, matrix, sfc or sf objects. The way identifier are handled has also been improved (use of row.names or indexes if row.names are not relevant, e.g.&nbsp;for sfc objects or some matrices).</p>
<p>See the <a href="https://raw.githubusercontent.com/riatelab/osrm/master/NEWS">NEWS file</a> for the complete list of changes.</p>
</section>
</section>
<section id="the-paper-in-joss" class="level2">
<h2 class="anchored" data-anchor-id="the-paper-in-joss">The paper in JOSS</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://joss.theoj.org/papers/10.21105/joss.04574"><img src="https://rcarto.github.io/posts/osrm_v4.0.0/2022-11-04_12-42.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><em>From <a href="https://joss.readthedocs.io/en/latest/submitting.html">JOSS documentation</a></em>:<br>
JOSS publishes articles about research software. JOSS submissions must be open source and have an obvious research application. After submission an editor will carry out an initial check of your submission, and proceed to assign a handling editor. The handling editor will assign two or more JOSS reviewers, and the review will be carried out in the JOSS reviews repository. Authors will respond to reviewer-raised issues on the submission repository’s issue tracker.</p>
<p>The review process of the paper happens in the open. You can have a look at it <a href="https://github.com/openjournals/joss-reviews/issues/4574">here</a>.<br>
Submitting a paper to JOSS assure you to have your software inspected by a set of competent people and I can say that this process help me to make the package more ergonomic and reliable.</p>
<p>If you want more detailed information on JOSS, a paper by <span class="citation" data-cites="smith2018">Smith et al. (2018)</span> describes the motivation, design, and progress of the journal.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-giraud2022" class="csl-entry">
Giraud, Timothée. 2022. <span>“<span class="nocase">osrm: Interface Between R and the OpenStreetMap-Based Routing Service OSRM</span>.”</span> <em>Journal of Open Source Software</em> 7 (78): 4574. <a href="https://doi.org/10.21105/joss.04574">https://doi.org/10.21105/joss.04574</a>.
</div>
<div id="ref-luxen-vetter-2011" class="csl-entry">
Luxen, Dennis, and Christian Vetter. 2011. <span>“Real-Time Routing with OpenStreetMap Data.”</span> In <em>Proceedings of the 19th ACM SIGSPATIAL International Conference on Advances in Geographic Information Systems</em>, 513–16. GIS ’11. New York, NY, USA: ACM. <a href="https://doi.org/10.1145/2093973.2094062">https://doi.org/10.1145/2093973.2094062</a>.
</div>
<div id="ref-smith2018" class="csl-entry">
Smith, Arfon M., Kyle E. Niemeyer, Daniel S. Katz, Lorena A. Barba, George Githinji, Melissa Gymrek, Kathryn D. Huff, et al. 2018. <span>“<span>Journal of Open Source Software (JOSS): Design and First-Year Review</span>.”</span> <em>PeerJ Computer Science</em> 4 (February): e147. <a href="https://doi.org/10.7717/peerj-cs.147">https://doi.org/10.7717/peerj-cs.147</a>.
</div>
</div></section></div> ]]></description>
  <category>osrm</category>
  <guid>https://rcarto.github.io/posts/osrm_v4.0.0/index.html</guid>
  <pubDate>Thu, 03 Nov 2022 23:00:00 GMT</pubDate>
  <media:content url="https://rcarto.github.io/posts/osrm_v4.0.0/osrm.png" medium="image" type="image/png" height="167" width="144"/>
</item>
</channel>
</rss>
